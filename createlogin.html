<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>System Enrollment | Northwall Compliance Group</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;900&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { onyx: '#050505', royal: '#0A1F2E' },
          fontFamily: { sans: ['Inter', 'sans-serif'], glam: ['Playfair Display', 'serif'] }
        }
      }
    }
  </script>
  <style>
    .vault-glass {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(45px) saturate(210%);
      -webkit-backdrop-filter: blur(45px) saturate(210%);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 60px 120px -20px rgba(0,0,0,0.6);
    }
    
    .carved-input {
      background: rgba(0, 0, 0, 0.25);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.4);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    
    .carved-input:focus {
      background: rgba(0, 0, 0, 0.45);
      border-color: #3b82f6;
      box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.6), 0 0 25px rgba(59, 130, 246, 0.2);
      transform: scale(1.01);
    }

    @keyframes aurora {
      0% { transform: translate(0,0) scale(1); }
      50% { transform: translate(5%, 5%) scale(1.1); }
      100% { transform: translate(0,0) scale(1); }
    }
    .animate-aurora { animation: aurora 18s infinite alternate ease-in-out; }
    
    .step-fade { transition: opacity 0.5s ease, transform 0.5s ease; }
    .hidden-step { display: none; opacity: 0; transform: translateY(10px); }
  </style>
</head>

<body class="bg-[#01040f] text-white font-sans overflow-x-hidden min-h-screen flex items-center justify-center py-20">

  <div class="fixed inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-[-10%] right-[-10%] w-[80%] h-[80%] bg-blue-900/15 rounded-full blur-[140px] animate-aurora"></div>
    <div class="absolute bottom-[-10%] left-[-10%] w-[60%] h-[60%] bg-slate-800/20 rounded-full blur-[120px] animate-aurora" style="animation-delay: -7s;"></div>
  </div>

  <div class="relative z-10 w-full max-w-2xl px-6">
    
    <div class="text-center mb-10">
      <div class="inline-flex items-center space-x-4 mb-4">
        <img src="images/logo.png" class="h-10 w-auto invert opacity-80" alt="Northwall">
        <div class="h-8 w-[1px] bg-white/10"></div>
        <div class="text-left leading-tight">
          <span class="text-xl font-glam block tracking-tight">Northwall</span>
          <span class="text-[7px] font-black uppercase tracking-[0.4em] text-blue-500/80">Compliance Group</span>
        </div>
      </div>
    </div>

    <div class="vault-glass rounded-[3.5rem] p-10 md:p-16 relative overflow-hidden">
      
      <div class="flex justify-between items-center mb-12 px-2">
        <div id="dot1" class="h-1.5 w-1/3 bg-blue-600 rounded-full transition-all duration-500"></div>
        <div id="dot2" class="h-1.5 w-1/3 bg-white/10 rounded-full mx-2 transition-all duration-500"></div>
        <div id="dot3" class="h-1.5 w-1/3 bg-white/10 rounded-full transition-all duration-500"></div>
      </div>

      <form id="regForm">
        
        <div id="step1" class="step-fade space-y-8">
          <div class="text-center mb-10">
            <h1 class="text-3xl font-glam mb-2">Create Account</h1>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="space-y-3">
              <label class="text-[9px] font-black uppercase tracking-[0.4em] text-white/40 ml-2">First Name</label>
              <input type="text" id="firstName" required class="carved-input w-full rounded-2xl px-6 py-4 text-sm outline-none placeholder:text-white/5 font-medium">
            </div>
            <div class="space-y-3">
              <label class="text-[9px] font-black uppercase tracking-[0.4em] text-white/40 ml-2">Last Name</label>
              <input type="text" id="lastName" required  class="carved-input w-full rounded-2xl px-6 py-4 text-sm outline-none placeholder:text-white/5 font-medium">
            </div>
          </div>

          <div class="space-y-3">
            <label class="text-[9px] font-black uppercase tracking-[0.4em] text-white/40 ml-2">Email</label>
            <input type="email" id="email" required placeholder="email" class="carved-input w-full rounded-2xl px-6 py-4 text-sm outline-none placeholder:text-white/5 font-medium">
          </div>

          <button type="button" onclick="nextStep(2)" class="group relative w-full py-5 rounded-2xl overflow-hidden transition-all duration-500 hover:-translate-y-1 shadow-2xl bg-white">
            <span class="relative text-onyx text-[10px] font-black uppercase tracking-[0.4em]">Next: Facility Details</span>
          </button>
        </div>

        <div id="step2" class="step-fade hidden-step space-y-8">
          <div class="text-center mb-10">
            <h1 class="text-3xl font-glam mb-2">Facility Profile</h1>
          </div>

          <div class="space-y-3">
            <label class="text-[9px] font-black uppercase tracking-[0.4em] text-white/40 ml-2">Facility Name</label>
            <input type="text" id="facilityName" required  class="carved-input w-full rounded-2xl px-6 py-4 text-sm outline-none placeholder:text-white/5 font-medium">
          </div>

          <div class="space-y-3">
            <label class="text-[9px] font-black uppercase tracking-[0.4em] text-white/40 ml-2">Professional Role</label>
            <select id="role" class="carved-input w-full rounded-2xl px-6 py-4 text-sm outline-none font-medium appearance-none text-white/60">
              <option>Director (ALD)</option>
              <option>Owner</option>
              <option>Clinical Lead (RN)</option>
              <option>Compliance Officer</option>
              <option>Other</option>
            </select>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <button type="button" onclick="nextStep(1)" class="py-5 rounded-2xl border border-white/10 text-[9px] font-black uppercase tracking-widest text-white/40 hover:bg-white/5 transition-all">Back</button>
            <button type="button" onclick="nextStep(3)" class="py-5 rounded-2xl bg-white text-onyx text-[9px] font-black uppercase tracking-widest hover:-translate-y-1 transition-all">Continue</button>
          </div>
        </div>

        <div id="step3" class="step-fade hidden-step space-y-8">
          <div class="text-center mb-10">
            <p class="text-[9px] font-black uppercase tracking-[0.3em] text-white/30">Set Password</p>
          </div>

          <div class="space-y-3">
            <label class="text-[9px] font-black uppercase tracking-[0.4em] text-white/40 ml-2">Choose Password</label>
            <input type="password" id="password" required class="carved-input w-full rounded-2xl px-6 py-4 text-sm outline-none font-medium">
          </div>

          <div class="space-y-3">
            <label class="text-[9px] font-black uppercase tracking-[0.4em] text-white/40 ml-2">Confirm Password</label>
            <input type="password" id="confirmPassword" required class="carved-input w-full rounded-2xl px-6 py-4 text-sm outline-none font-medium">
          </div>

          <div class="flex items-start space-x-3 px-2">
            <input type="checkbox" required class="mt-1 h-3 w-3 bg-black rounded border-white/10 text-blue-600 focus:ring-0">
            <span class="text-[8px] font-medium leading-relaxed text-white/30 uppercase tracking-wider">I authorize Northwall Compliance to synchronize my data and agree to the <a href="#" class="text-blue-500 underline">Terms of Service</a>.</span>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <button type="button" onclick="nextStep(2)" class="py-5 rounded-2xl border border-white/10 text-[9px] font-black uppercase tracking-widest text-white/40">Back</button>
            <button type="submit" class="py-5 rounded-2xl bg-blue-600 text-white text-[9px] font-black uppercase tracking-widest hover:bg-blue-500 transition-all shadow-2xl shadow-blue-900/20">Establish Account</button>
          </div>
        </div>

      </form>

      <div class="mt-10 text-center">
        <a href="login.html" class="text-[10px] font-black uppercase tracking-widest text-white/20 hover:text-white transition-all">Already a member? <span class="text-blue-500">Login</span></a>
      </div>

    </div>

  </div>

<script type="module">
  import { auth } from './firebase-config.js';
  // We added updateProfile to the import list here
  import { createUserWithEmailAndPassword, updateProfile } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

  // Step Navigation Logic
  window.nextStep = function(step) {
    document.querySelectorAll('.step-fade').forEach(el => el.classList.add('hidden-step'));
    const target = document.getElementById('step' + step);
    if(target) target.classList.remove('hidden-step');
    
    document.getElementById('dot1').className = `h-1.5 w-1/3 rounded-full transition-all duration-500 ${step >= 1 ? 'bg-blue-600' : 'bg-white/10'}`;
    document.getElementById('dot2').className = `h-1.5 w-1/3 rounded-full mx-2 transition-all duration-500 ${step >= 2 ? 'bg-blue-600' : 'bg-white/10'}`;
    document.getElementById('dot3').className = `h-1.5 w-1/3 rounded-full transition-all duration-500 ${step >= 3 ? 'bg-blue-600' : 'bg-white/10'}`;
  }

  // Firebase Registration Logic
  document.getElementById('regForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    
    // Grab the names for the profile
    const firstName = document.getElementById('firstName').value;
    const lastName = document.getElementById('lastName').value;

    if (password !== confirmPassword) {
      alert("Passwords do not match.");
      return;
    }

    const btn = e.target.querySelector('button[type="submit"]');
    const originalText = btn.innerText;
    btn.innerText = 'ESTABLISHING VAULT...';
    btn.disabled = true;

    // 1. Create the account
    createUserWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        // 2. Immediately save the First and Last Name to the profile
        return updateProfile(userCredential.user, {
          displayName: `${firstName} ${lastName}`
        });
      })
      .then(() => {
        // 3. Success: Go to home page
        window.location.href = "index.html"; 
      })
      .catch((error) => {
        btn.innerText = originalText;
        btn.disabled = false;
        alert("Registration Error: " + error.message);
      });
  });
</script>


</body>
</html>
